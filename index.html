<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Valentine ‚ù§Ô∏è</title>
  <style>
    :root{
      --text: #ffffff;
      --yes: #1fb35a;
      --no: #e53935;
    }

    *{ box-sizing: border-box; }
    html, body { height: 100%; margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; }

    /* Background slideshow */
    .bg {
      position: fixed;
      inset: 0;
      overflow: hidden;
      z-index: -2;
      background: #000;
    }
    .bg::after{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(circle at 20% 10%, rgba(0,0,0,.10), rgba(0,0,0,.40));
      z-index: 1;
      pointer-events:none;
    }
    .bg-slide {
      position: absolute;
      inset: 0;
      background-size: contain;       /* fit */
      background-repeat: no-repeat;
      background-position: center;
      opacity: 0;
      transition: opacity 900ms ease;
    }
    .bg-slide.active { opacity: 1; }

    /* Bottom layout */
    .wrap{
      min-height: 100%;
      display: grid;
      grid-template-rows: 1fr auto; /* push content to bottom */
      padding: 18px;
      color: var(--text);
    }

    /* Bottom ‚Äúpanel‚Äù area */
    .panel{
      width: min(720px, 96vw);
      margin: 0 auto;
      position: relative;
      overflow: hidden; /* keep No inside the panel */
      padding: 0 0 10px 0;
    }

    /* Question pill */
    .topText{
      width: 100%;
      text-align: center;
      padding: 14px 18px;
      border-radius: 18px;
      background: rgba(0,0,0,0.28);
      border: 1px solid rgba(255,255,255,0.18);
      text-shadow: 0 8px 22px rgba(0,0,0,.35);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
    }
    h1{
      margin: 0 0 10px 0;
      font-size: clamp(26px, 4vw, 42px);
      letter-spacing: .2px;
    }
    .sub{
      margin: 0;
      font-size: 15px;
      opacity: .92;
    }

    /* Buttons row */
    .buttonsRow{
      margin-top: 12px;
      display: flex;
      gap: 14px;
      justify-content: center;
      align-items: center;
      position: relative;
      z-index: 5;
    }

    .btn{
      border: none;
      border-radius: 999px;
      padding: 14px 28px;
      font-size: 18px;
      font-weight: 800;
      cursor: pointer;
      color: white;
      transition: transform 200ms ease, box-shadow 200ms ease, filter 200ms ease;
      box-shadow: 0 12px 26px rgba(0,0,0,.25);
      user-select: none;
      touch-action: manipulation;
      position: relative;
      white-space: nowrap;
    }
    .btn:active{ transform: translateY(1px) scale(0.99); }

    #yesBtn{ background: var(--yes); }
    #yesBtn:hover{ filter: brightness(1.05); }

    #noBtn{
      background: var(--no);
      z-index: 10;
    }

    .message{
      margin-top: 12px;
      padding: 14px 18px;
      border-radius: 18px;
      background: rgba(0,0,0,0.30);
      border: 1px solid rgba(255,255,255,0.18);
      font-size: 18px;
      font-weight: 750;
      display: none;
      text-align: center;
      text-shadow: 0 8px 22px rgba(0,0,0,.35);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
    }

    /* Hearts */
    .hearts{
      position: absolute;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      border-radius: 18px;
      z-index: 1;
    }
    .heart{
      position: absolute;
      bottom: -40px;
      font-size: 22px;
      opacity: .0;
      animation: floatUp 5.8s linear infinite;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.15));
    }
    @keyframes floatUp{
      0%   { transform: translateY(0) translateX(0) scale(.9); opacity: 0; }
      10%  { opacity: .7; }
      60%  { opacity: .55; }
      100% { transform: translateY(-520px) translateX(40px) scale(1.2); opacity: 0; }
    }

    @media (max-width: 520px){
      .btn{ padding: 14px 24px; font-size: 17px; }
      .wrap{ padding: 14px; }
    }
  </style>
</head>

<body>
  <div class="bg" aria-hidden="true">
    <div id="bgA" class="bg-slide active"></div>
    <div id="bgB" class="bg-slide"></div>
  </div>

  <div class="wrap">
    <!-- empty row above pushes panel down -->
    <div></div>

    <div class="panel" id="panel">
      <div class="hearts" aria-hidden="true" id="hearts"></div>

      <div class="topText" id="topText">
        <h1 id="question">Will you be my Valentine?</h1>
        <p class="sub" id="hint">Choose wisely üòå</p>
      </div>

      <div class="buttonsRow" id="buttonsRow">
        <button class="btn" id="yesBtn">Yes</button>
        <button class="btn" id="noBtn" type="button">No</button>
      </div>

      <div class="message" id="finalMsg">
        Thank You for being my Valentine now and forever. I love you!!!
      </div>
    </div>
  </div>

  <script>
    /**********************
     * 1) BACKGROUND SLIDESHOW
     **********************/
    const bgImages = [
      ...Array.from({ length: 12 }, (_, i) => `Picture${i+1}.jpg`),
      "Picture13.jpeg",
      "Picture14.jpeg"
    ];

    const bgA = document.getElementById("bgA");
    const bgB = document.getElementById("bgB");
    let bgIndex = 0;
    let showA = true;

    function setBg(el, url){
      el.style.backgroundImage = `url("${url}")`;
    }

    setBg(bgA, bgImages[0] || "");
    setBg(bgB, bgImages[1] || bgImages[0] || "");

    setInterval(() => {
      if (!bgImages.length) return;
      bgIndex = (bgIndex + 1) % bgImages.length;

      const next = bgImages[bgIndex];
      const front = showA ? bgB : bgA;
      const back  = showA ? bgA : bgB;

      setBg(front, next);
      front.classList.add("active");
      back.classList.remove("active");

      showA = !showA;
    }, 3000);

    /**********************
     * 2) BUTTON LOGIC
     **********************/
    const yesBtn = document.getElementById("yesBtn");
    const noBtn = document.getElementById("noBtn");
    const panel = document.getElementById("panel");
    const buttonsRow = document.getElementById("buttonsRow");
    const topText = document.getElementById("topText");
    const finalMsg = document.getElementById("finalMsg");

    let hoverCount = 0;
    let noLockedToAngry = false;
    let noDetached = false;

    noBtn.addEventListener("click", (e) => {
      e.preventDefault();
      e.stopPropagation();
      return false;
    });

    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

    // Detach No into the panel so it can move freely but remain inside the panel
    function detachNoIfNeeded(){
      if (noDetached) return;
      noDetached = true;

      const panelRect = panel.getBoundingClientRect();
      const noRect = noBtn.getBoundingClientRect();

      panel.appendChild(noBtn);
      noBtn.style.position = "absolute";
      noBtn.style.left = `${noRect.left - panelRect.left}px`;
      noBtn.style.top  = `${noRect.top - panelRect.top}px`;
      noBtn.style.zIndex = 10;
    }

    // We define a safe play area INSIDE the panel:
    // - below the topText (question pill)
    // - below the buttonsRow so it doesn't cover Yes or the row itself
    // - and with a "No-Fly-Zone" around Yes to prevent overlap
    function getSafeZone() {
      const panelRect = panel.getBoundingClientRect();
      const topRect = topText.getBoundingClientRect();
      const rowRect = buttonsRow.getBoundingClientRect();
      const yRect = yesBtn.getBoundingClientRect();
      const nRect = noBtn.getBoundingClientRect();

      const padding = 10;

      // Start after the buttons row (so No never appears on top of it)
      const startY = (rowRect.bottom - panelRect.top) + 12;

      const safeLeft = padding;
      const safeRight = panelRect.width - nRect.width - padding;
      const safeTop = clamp(startY, padding, panelRect.height - nRect.height - padding);
      const safeBottom = panelRect.height - nRect.height - padding;

      // Extra-large buffer around Yes (prevents overlap even if sizes change)
      const buffer = 26;
      const yesBox = {
        left:  (yRect.left - panelRect.left) - buffer,
        right: (yRect.right - panelRect.left) + buffer,
        top:   (yRect.top - panelRect.top) - buffer,
        bottom:(yRect.bottom - panelRect.top) + buffer
      };

      return { panelRect, nRect, safeLeft, safeTop, safeRight, safeBottom, yesBox, padding };
    }

    function overlapsBox(x, y, box, nRect) {
      const noBox = {
        left: x,
        right: x + nRect.width,
        top: y,
        bottom: y + nRect.height
      };
      return !(
        noBox.right < box.left ||
        noBox.left > box.right ||
        noBox.bottom < box.top ||
        noBox.top > box.bottom
      );
    }

    function placeNo(x, y, panelRect, nRect, padding) {
      const minX = padding;
      const maxX = panelRect.width - nRect.width - padding;
      const minY = padding;
      const maxY = panelRect.height - nRect.height - padding;

      const cx = clamp(x, minX, maxX);
      const cy = clamp(y, minY, maxY);

      noBtn.style.left = `${cx}px`;
      noBtn.style.top  = `${cy}px`;
    }

    function dodgeNoButton() {
      if (noLockedToAngry) return;

      detachNoIfNeeded();

      const { panelRect, nRect, safeLeft, safeTop, safeRight, safeBottom, yesBox, padding } = getSafeZone();

      const rangeX = Math.max(0, safeRight - safeLeft);
      const rangeY = Math.max(0, safeBottom - safeTop);

      let tries = 0;
      let x, y;

      // Try multiple times to find a spot that doesn't overlap the Yes no-fly zone
      do {
        x = safeLeft + Math.random() * rangeX;
        y = safeTop  + Math.random() * Math.max(rangeY, 8);
        tries++;
      } while (overlapsBox(x, y, yesBox, nRect) && tries < 80);

      // If we *still* overlap (rare), force it far left or far right
      if (overlapsBox(x, y, yesBox, nRect)) {
        const farLeftX = safeLeft;
        const farRightX = safeRight;
        // pick the side farther from Yes center
        const yesCenterX = (yesBox.left + yesBox.right) / 2;
        x = (Math.abs(farLeftX - yesCenterX) > Math.abs(farRightX - yesCenterX)) ? farLeftX : farRightX;
      }

      placeNo(x, y, panelRect, nRect, padding);
    }

    function updateNoCaption() {
      if (noLockedToAngry) {
        noBtn.textContent = "üò°";
        return;
      }
      if (hoverCount === 0) noBtn.textContent = "Are you sure?";
      else if (hoverCount === 1) noBtn.textContent = "I thought you loved me?";
      else if (hoverCount === 2) noBtn.textContent = "Baby, please!";
      else if (hoverCount === 3) noBtn.textContent = "This is not acceptable";
      else {
        noBtn.textContent = "üò°";
        noLockedToAngry = true;
      }
    }

    function growYesButton() {
      const growthSteps = Math.min(hoverCount + 1, 5);
      const scale = 1 + growthSteps * 0.12;
      yesBtn.style.transform = `scale(${scale})`;
      yesBtn.style.boxShadow = "0 16px 34px rgba(0,0,0,.28)";
    }

    noBtn.addEventListener("mouseenter", () => {
      updateNoCaption();
      dodgeNoButton();
      if (hoverCount < 5) growYesButton();
      hoverCount++;
    });

    noBtn.addEventListener("mousemove", () => {
      dodgeNoButton();
    });

    yesBtn.addEventListener("click", () => {
      topText.style.display = "none";
      buttonsRow.style.display = "none";
      finalMsg.style.display = "block";
      launchHearts();
    });

    /**********************
     * 3) HEARTS
     **********************/
    const heartsLayer = document.getElementById("hearts");
    let heartsTimer = null;

    function launchHearts() {
      if (heartsTimer) return;

      const heartChars = ["‚ù§Ô∏è","üíñ","üíï","üíò","üíó"];
      heartsTimer = setInterval(() => {
        const h = document.createElement("div");
        h.className = "heart";
        h.textContent = heartChars[Math.floor(Math.random() * heartChars.length)];

        const w = panel.getBoundingClientRect().width;
        h.style.left = `${Math.random() * (w - 30)}px`;
        h.style.animationDuration = `${4.8 + Math.random() * 2.4}s`;
        h.style.opacity = "0";

        heartsLayer.appendChild(h);
        setTimeout(() => h.remove(), 7000);
      }, 220);
    }

    window.addEventListener("error", () => {
      bgA.style.backgroundImage = "linear-gradient(120deg, #ff5f9e, #ffd1dc)";
      bgB.style.backgroundImage = "linear-gradient(120deg, #ff9a5f, #ffe28a)";
    }, true);
  </script>
</body>
</html>